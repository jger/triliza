diff --git a/node_modules/test-exclude/index.js b/node_modules/test-exclude/index.js
index aecb72d..e77e75f 100644
--- a/node_modules/test-exclude/index.js
+++ b/node_modules/test-exclude/index.js
@@ -2,7 +2,22 @@
 
 const path = require('path');
 const { promisify } = require('util');
-const glob = promisify(require('glob'));
+const globModule = require('glob');
+const globCallback =
+    typeof globModule === 'function'
+        ? globModule
+        : typeof globModule?.glob === 'function'
+        ? globModule.glob
+        : null;
+
+if (!globCallback) {
+    throw new Error('test-exclude: glob module did not expose a callback API');
+}
+
+const glob = promisify(globCallback);
+if (typeof globCallback.sync === 'function') {
+    glob.sync = globCallback.sync.bind(globCallback);
+}
 const minimatch = require('minimatch');
 const { defaults } = require('@istanbuljs/schema');
 const isOutsideDir = require('./is-outside-dir');
