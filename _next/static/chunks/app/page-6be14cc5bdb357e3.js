(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{63:()=>{},7273:(e,t,n)=>{Promise.resolve().then(n.bind(n,7319))},7319:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>J});var o=n(5155),i=n(2115),r=n(6367),s=n(694),l=n(79),a=n(1357);let c="playing",d="game_over",h={board:[[]],currentPlayer:"X",moveCounter:0,gameHistory:[],gameStatus:c,scoreX:0,scoreO:0,dimension:3},u=e=>{let t=[];for(let n=0;n<e;n++){t[n]=[];for(let o=0;o<e;o++)t[n][o]=o+e*n+1}return t},g=e=>"X"!==e&&"O"!==e,m=(e,t)=>{switch(t.type){case"MAKE_MOVE":{var n,o;let i,l,{row:a,col:h}=t.payload,u=e.board.map(e=>[...e]);if(!g(u[a][h]))return e;u[a][h]=e.currentPlayer;let m=(n=e.currentPlayer,o=e.dimension,i=0,a-1>=0&&a+1<o&&u[a-1][h]===n&&u[a+1][h]===n&&i++,h-1>=0&&h+1<o&&u[a][h-1]===n&&u[a][h+1]===n&&i++,a-2>=0&&u[a-1][h]===n&&u[a-2][h]===n&&i++,h-2>=0&&u[a][h-1]===n&&u[a][h-2]===n&&i++,a+2<o&&u[a+1][h]===n&&u[a+2][h]===n&&i++,h+2<o&&u[a][h+1]===n&&u[a][h+2]===n&&i++,a-2>=0&&h-2>=0&&u[a-2][h-2]===n&&u[a-1][h-1]===n&&i++,a+2<o&&h+2<o&&u[a+2][h+2]===n&&u[a+1][h+1]===n&&i++,a-1>=0&&h-1>=0&&a+1<o&&h+1<o&&(u[a+1][h-1]===n&&u[a-1][h+1]===n&&i++,u[a-1][h-1]===n&&u[a+1][h+1]===n&&i++),h-2>=0&&a+2<o&&u[a+1][h-1]===n&&u[a+2][h-2]===n&&i++,a-2>=0&&h+2<o&&u[a-1][h+1]===n&&u[a-2][h+2]===n&&i++,i),y=h+e.dimension*a+1,x=e.moveCounter+1,p=x>=(l=e.dimension)*l;return(0,s._)((0,r._)({},e),{board:u,currentPlayer:"X"===e.currentPlayer?"O":"X",moveCounter:x,gameHistory:[...e.gameHistory,y],gameStatus:p?d:c,scoreX:"X"===e.currentPlayer?e.scoreX+m:e.scoreX,scoreO:"O"===e.currentPlayer?e.scoreO+m:e.scoreO})}case"RESET_GAME":return(0,s._)((0,r._)({},h),{dimension:e.dimension,board:u(e.dimension)});case"CHANGE_DIMENSION":{let e=t.payload.dimension;return(0,s._)((0,r._)({},h),{dimension:e,board:u(e)})}case"SYNC_GAME_STATE":return(0,r._)({},e,t.payload);default:return e}},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,[t,n]=(0,i.useReducer)(m,(0,s._)((0,r._)({},h),{board:u(h.dimension)})),o=(0,i.useRef)(null),l=(0,i.useRef)(!1),a=(0,i.useCallback)((e,t)=>{n({type:"MAKE_MOVE",payload:{row:e,col:t}})},[]),c=(0,i.useCallback)(()=>{n({type:"RESET_GAME"})},[]),d=(0,i.useCallback)(e=>{n({type:"CHANGE_DIMENSION",payload:{dimension:e}})},[]),g=(0,i.useCallback)(e=>{console.log("Receiving game state update:",e),l.current=!0,n({type:"SYNC_GAME_STATE",payload:e}),l.current=!1},[]);return(0,i.useEffect)(()=>{if(e&&!l.current){let n=JSON.stringify(t);o.current!==n&&(console.log("Sending game state update:",t),o.current=n,e(t))}},[t,e]),{gameState:t,actions:{makeMove:a,resetGame:c,changeDimension:d,syncGameState:g}}};var x=n(8617);class p{generateInvitationCode(){return(0,x.Ak)(6).toUpperCase()}async createConnection(){var e,t;let n=!(arguments.length>0)||void 0===arguments[0]||arguments[0],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(this.isHost=n,this.invitationCode=o,this.connectionStatus="connecting",null==(e=this.onConnectionChange)||e.call(this,"connecting"),this.peerConnection=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]}),this.setupEventListeners(),this.iceCandidates=[],n){this.dataChannel=this.peerConnection.createDataChannel("gameData",{ordered:!0}),this.setupDataChannel(this.dataChannel);let e=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(e),this.localOffer=e,console.log("Host created offer:",e)}else this.peerConnection.ondatachannel=e=>{console.log("Guest received data channel:",e.channel),this.dataChannel=e.channel,this.setupDataChannel(this.dataChannel)};return this.timeRemaining=300,this.startTimer(),this.connectionTimeout=setTimeout(()=>{if("connecting"===this.connectionStatus){var e;console.log("Connection timeout"),this.connectionStatus="error",null==(e=this.onConnectionChange)||e.call(this,"error"),this.stopTimer()}},3e5),this.peerConnection}catch(e){throw console.error("Failed to create WebRTC connection:",e),this.connectionStatus="error",null==(t=this.onConnectionChange)||t.call(this,"error"),e}}setupEventListeners(){this.peerConnection&&(this.peerConnection.onicecandidate=e=>{e.candidate?(console.log("New ICE candidate:",e.candidate),this.iceCandidates.push(e.candidate)):(console.log("ICE gathering complete"),this.iceGatheringComplete=!0)},this.peerConnection.onconnectionstatechange=()=>{var e,t;let n=this.peerConnection.connectionState;console.log("Connection state changed:",n),"connected"===n?(this.connectionTimeout&&(clearTimeout(this.connectionTimeout),this.connectionTimeout=null),this.stopTimer(),this.connectionStatus="connected",null==(e=this.onConnectionChange)||e.call(this,"connected")):("failed"===n||"disconnected"===n)&&(this.connectionTimeout&&(clearTimeout(this.connectionTimeout),this.connectionTimeout=null),this.stopTimer(),this.connectionStatus="error",null==(t=this.onConnectionChange)||t.call(this,"error"))},this.peerConnection.oniceconnectionstatechange=()=>{console.log("ICE connection state:",this.peerConnection.iceConnectionState)})}setupDataChannel(e){e.onopen=()=>{var e;console.log("Data channel opened"),this.connectionTimeout&&(clearTimeout(this.connectionTimeout),this.connectionTimeout=null),this.stopTimer(),this.connectionStatus="connected",null==(e=this.onConnectionChange)||e.call(this,"connected")},e.onmessage=e=>{try{var t;let n=JSON.parse(e.data);console.log("Received message:",n),null==(t=this.onDataReceived)||t.call(this,n)}catch(e){console.error("Failed to parse received data:",e)}},e.onerror=e=>{var t;console.error("Data channel error:",e),this.connectionStatus="error",null==(t=this.onConnectionChange)||t.call(this,"error")},e.onclose=()=>{var e;console.log("Data channel closed"),this.connectionStatus="disconnected",null==(e=this.onConnectionChange)||e.call(this,"disconnected")}}async connectWithOffer(e){if(!this.peerConnection)throw Error("Peer connection not initialized");try{console.log("Guest connecting with offer:",e),await this.peerConnection.setRemoteDescription(new RTCSessionDescription(e));let t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t),localStorage.setItem("guestAnswer_".concat(this.invitationCode),JSON.stringify(t)),console.log("Guest created answer:",t)}catch(e){throw console.error("Failed to connect with offer:",e),e}}async connectWithAnswer(e){if(!this.peerConnection)throw Error("Peer connection not initialized");try{console.log("Host connecting with answer:",e),await this.peerConnection.setRemoteDescription(new RTCSessionDescription(e))}catch(e){throw console.error("Failed to connect with answer:",e),e}}async addIceCandidate(e){if(!this.peerConnection)throw Error("Peer connection not initialized");try{console.log("Adding ICE candidate:",e),await this.peerConnection.addIceCandidate(new RTCIceCandidate(e))}catch(e){console.error("Failed to add ICE candidate:",e)}}sendData(e){if(this.dataChannel&&"open"===this.dataChannel.readyState)try{console.log("Sending data:",e),this.dataChannel.send(JSON.stringify(e))}catch(e){console.error("Failed to send data:",e)}else{var t;console.log("Data channel not ready, state:",null==(t=this.dataChannel)?void 0:t.readyState)}}startTimer(){this.stopTimer(),this.connectionTimer=setInterval(()=>{var e;this.timeRemaining--,null==(e=this.onTimerUpdate)||e.call(this,this.timeRemaining),this.timeRemaining<=0&&this.stopTimer()},1e3)}stopTimer(){this.connectionTimer&&(clearInterval(this.connectionTimer),this.connectionTimer=null)}getTimeRemaining(){return this.timeRemaining}disconnect(){var e;this.connectionTimeout&&(clearTimeout(this.connectionTimeout),this.connectionTimeout=null),this.stopTimer(),this.dataChannel&&(this.dataChannel.close(),this.dataChannel=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.connectionStatus="disconnected",null==(e=this.onConnectionChange)||e.call(this,"disconnected");try{this.invitationCode&&(localStorage.removeItem("hostOffer_".concat(this.invitationCode)),localStorage.removeItem("guestAnswer_".concat(this.invitationCode)),localStorage.removeItem("hostCandidate_".concat(this.invitationCode)),localStorage.removeItem("guestCandidate_".concat(this.invitationCode)))}catch(e){console.error("Failed to clean up localStorage:",e)}}getConnectionStatus(){return this.connectionStatus}getConnectionData(){return this.isHost&&this.localOffer?{type:"offer",sdp:this.localOffer,candidates:this.iceCandidates}:!this.isHost&&this.localAnswer?{type:"answer",sdp:this.localAnswer,candidates:this.iceCandidates}:null}getConnectionString(){let e=this.getConnectionData();return e?btoa(JSON.stringify(e)):null}async handleConnectionString(e){try{let t=JSON.parse(atob(e));if(console.log("Handling connection data:",t),"offer"!==t.type||this.isHost){if("answer"===t.type&&this.isHost){for(let e of(await this.peerConnection.setRemoteDescription(new RTCSessionDescription(t.sdp)),t.candidates))await this.peerConnection.addIceCandidate(new RTCIceCandidate(e));console.log("Host processed answer")}}else{for(let e of(await this.peerConnection.setRemoteDescription(new RTCSessionDescription(t.sdp)),t.candidates))await this.peerConnection.addIceCandidate(new RTCIceCandidate(e));let e=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(e),this.localAnswer=e,console.log("Guest created answer")}}catch(e){throw console.error("Failed to handle connection string:",e),e}}constructor(){this.invitationCode=null,this.iceCandidates=[],this.iceGatheringComplete=!1,this.localOffer=null,this.localAnswer=null,this.peerConnection=null,this.dataChannel=null,this.connectionStatus="disconnected",this.onDataReceived=null,this.onConnectionChange=null,this.isHost=!1,this.connectionTimeout=null,this.connectionTimer=null,this.timeRemaining=0,this.onTimerUpdate=null}}let C=async e=>{try{if(navigator.clipboard&&window.isSecureContext)return await navigator.clipboard.writeText(e),!0;{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();let n=document.execCommand("copy");return document.body.removeChild(t),n}}catch(e){return console.error("Failed to copy to clipboard:",e),!1}},f=e=>{let t=window.innerWidth,n=window.innerHeight,o=(e-1)*8;return Math.max(30,Math.min(Math.floor(Math.min((90*t/100-o)/e,(70*n/100-o)/e)),80))},b=e=>Math.max(16,Math.floor(.4*e)),A=(e,t)=>e*t+(e-1)*8+40;var j=n(1293),w=n(2806);n(63);let T=a.A.create({cell:{borderWidth:1,borderColor:"black",justifyContent:"center",alignItems:"center",backgroundColor:"#ccc",cursor:"pointer"},text:{fontWeight:"bold",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},empty:{backgroundColor:"#f0f0f0"},emptyText:{color:"#666"},disabled:{opacity:.6,cursor:"not-allowed"}}),S=e=>{let{value:t,onPress:n,disabled:i=!1,currentPlayer:l,onMouseEnter:a,cellSize:c,fontSize:d}=e,h=g(t),u=(0,s._)((0,r._)({},T.cell),{width:c,height:c,margin:4}),m=h?[u,T.empty]:u,y=h?[T.text,T.emptyText,{fontSize:d}]:[T.text,{fontSize:d}];return(0,o.jsx)(j.A,{style:[m,i&&T.disabled],onPress:i?void 0:n,onMouseEnter:a,children:(0,o.jsx)(w.A,{style:y,children:t})})},v=a.A.create({cursor:{position:"fixed",zIndex:1e3,backgroundColor:"rgba(255, 255, 255, 0.9)",borderRadius:8,padding:4,borderWidth:1,borderColor:"#ccc",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:4},symbol:{fontSize:16,fontWeight:"bold",textAlign:"center",minWidth:20},symbolX:{color:"#d32f2f"},symbolO:{color:"#2e7d32"}}),R=e=>{let{currentPlayer:t,isVisible:n,mousePosition:i}=e;if(!n||!i)return null;let a=(0,s._)((0,r._)({},v.cursor),{left:i.x+15,top:i.y-15});return(0,o.jsx)(l.A,{style:a,pointerEvents:"none",children:(0,o.jsx)(w.A,{style:[v.symbol,"X"===t?v.symbolX:v.symbolO],children:t})})},B=a.A.create({board:{alignItems:"center"},row:{flexDirection:"row"}}),k=e=>{let{board:t,onCellPress:n,gameStatus:r,currentPlayer:s,cellSize:a,fontSize:c,disabled:h=!1,gameMode:u="local"}=e,m=r===d,[y,x]=(0,i.useState)(null),[p,C]=(0,i.useState)(!1),f=(0,i.useCallback)(e=>{x({x:e.clientX,y:e.clientY})},[]),b=(0,i.useCallback)(e=>{!m&&!h&&g(e)&&C(!0)},[m,h]),A=(0,i.useCallback)(()=>{C(!1)},[]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.A,{style:B.board,onMouseMove:f,onMouseLeave:A,children:t.map((e,t)=>(0,o.jsx)(l.A,{style:B.row,children:e.map((e,i)=>(0,o.jsx)(S,{value:e,onPress:()=>{!h&&!m&&n(t,i)},disabled:m||h,currentPlayer:s,onMouseEnter:()=>b(e),cellSize:a,fontSize:c},"cell-".concat(t,"-").concat(i)))},"row-".concat(t)))}),(0,o.jsx)(R,{currentPlayer:s,isVisible:p,mousePosition:y})]})},P=a.A.create({container:{alignItems:"center",marginTop:20,padding:15,backgroundColor:"#f5f5f5",borderRadius:8,minWidth:250},statusText:{fontSize:18,fontWeight:"bold",marginBottom:10,textAlign:"center",color:"#333"},playerLabel:{fontSize:14,color:"#666",marginBottom:10,fontStyle:"italic"},scoreContainer:{flexDirection:"row",justifyContent:"space-around",width:"100%",marginBottom:10},scoreText:{fontSize:16,fontWeight:"600",color:"#333"},moveText:{fontSize:14,color:"#666",marginBottom:5},historyText:{fontSize:12,color:"#999",textAlign:"center"}}),z=e=>{let{currentPlayer:t,moveCounter:n,gameHistory:i,scoreX:r,scoreO:s,gameStatus:a,gameMode:c="local",connectionStatus:h="disconnected"}=e;return(0,o.jsxs)(l.A,{style:P.container,children:[(0,o.jsx)(w.A,{style:P.statusText,children:a===d?r>s?"Player X wins!":s>r?"Player O wins!":"It's a tie!":"local"!==c&&"connected"!==h?"Connecting...":"Player ".concat(t,"'s turn")}),"local"!==c?(0,o.jsx)(w.A,{style:P.playerLabel,children:"host"===c?"You are X":"guest"===c?"You are O":""}):null,(0,o.jsxs)(l.A,{style:P.scoreContainer,children:[(0,o.jsxs)(w.A,{style:P.scoreText,children:["X: ",r]}),(0,o.jsxs)(w.A,{style:P.scoreText,children:["O: ",s]})]}),(0,o.jsxs)(w.A,{style:P.moveText,children:["Moves: ",n]}),i.length>0?(0,o.jsxs)(w.A,{style:P.historyText,children:["History: ",i.join(", ")]}):null]})},W=a.A.create({container:{alignItems:"center",marginBottom:20},header:{flexDirection:"row",alignItems:"center",marginBottom:15},title:{fontSize:24,fontWeight:"bold",marginRight:15},dimensionControls:{flexDirection:"row"},button:{textAlign:"center",padding:8,margin:4,fontSize:16,backgroundColor:"#f0f0f0",minWidth:30,minHeight:30,borderRadius:4,cursor:"pointer",borderWidth:1,borderColor:"#ddd"},newGameButton:{backgroundColor:"#4caf50",color:"white",paddingHorizontal:16,fontSize:18,fontWeight:"bold"},disabled:{opacity:.5,cursor:"not-allowed"}}),I=e=>{let{dimension:t,onDecrease:n,onIncrease:i,onNewGame:r}=e,s=t>3;return(0,o.jsxs)(l.A,{style:W.container,children:[(0,o.jsxs)(l.A,{style:W.header,children:[(0,o.jsxs)(w.A,{style:W.title,children:[t,"-liza"]}),(0,o.jsxs)(l.A,{style:W.dimensionControls,children:[(0,o.jsx)(w.A,{style:[W.button,!s&&W.disabled],onPress:s?n:void 0,children:"-"}),(0,o.jsx)(w.A,{style:W.button,onPress:i,children:"+"})]})]}),(0,o.jsx)(w.A,{style:[W.button,W.newGameButton],onPress:r,children:"New Game"})]})};var D=n(6942),O=n(9845);let E=a.A.create({betaContainer:{alignItems:"center",marginBottom:10},betaLink:{paddingVertical:8,paddingHorizontal:12,backgroundColor:"transparent",borderRadius:6},betaLinkText:{color:"#2196F3",fontSize:14,textDecorationLine:"underline",cursor:"pointer"},container:{padding:20,backgroundColor:"#f5f5f5",borderRadius:8,marginBottom:20,minWidth:300,borderWidth:2,borderColor:"#FF9800"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},title:{fontSize:18,fontWeight:"bold",color:"#333"},closeButton:{padding:4,borderRadius:4,backgroundColor:"#ddd"},closeButtonText:{fontSize:16,color:"#666",fontWeight:"bold"},betaWarning:{fontSize:12,color:"#FF9800",textAlign:"center",marginBottom:15,fontStyle:"italic"},buttonContainer:{alignItems:"center"},button:{backgroundColor:"#2196F3",paddingVertical:12,paddingHorizontal:24,borderRadius:6,marginVertical:5,minWidth:120},buttonText:{color:"white",textAlign:"center",fontWeight:"600"},orText:{marginVertical:10,color:"#666"},joinContainer:{flexDirection:"row",alignItems:"center",gap:10},input:{borderWidth:1,borderColor:"#ddd",borderRadius:6,padding:12,fontSize:16,textAlign:"center",minWidth:120,textTransform:"uppercase"},textArea:{borderWidth:1,borderColor:"#ddd",borderRadius:6,padding:12,fontSize:12,minHeight:80,textAlignVertical:"top",flex:1,marginRight:10,fontFamily:"monospace"},readOnlyTextArea:{borderWidth:1,borderColor:"#ddd",borderRadius:6,padding:12,fontSize:12,minHeight:100,textAlignVertical:"top",flex:1,marginRight:10,backgroundColor:"#f5f5f5",fontFamily:"monospace"},dataContainer:{flexDirection:"row",alignItems:"flex-start",marginBottom:10},answerSection:{marginTop:15,paddingTop:15,borderTopWidth:1,borderTopColor:"#ddd"},processButton:{backgroundColor:"#4CAF50"},joinButton:{backgroundColor:"#4CAF50"},activeHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},statusContainer:{flexDirection:"row",alignItems:"center",gap:8},statusDot:{width:12,height:12,borderRadius:6},statusText:{fontSize:14,color:"#666"},timerText:{fontSize:12,color:"#FF9800",fontWeight:"bold",marginLeft:8},invitationContainer:{backgroundColor:"white",padding:15,borderRadius:6,marginBottom:15},invitationLabel:{fontSize:14,color:"#666",marginBottom:8},codeContainer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:8},codeText:{fontSize:24,fontWeight:"bold",color:"#2196F3",letterSpacing:2},copyButton:{backgroundColor:"#2196F3",paddingVertical:6,paddingHorizontal:12,borderRadius:4},copyButtonText:{color:"white",fontSize:12,fontWeight:"600"},instructionText:{fontSize:12,color:"#666",textAlign:"center"},warningText:{fontSize:11,color:"#FF9800",textAlign:"center",marginTop:8,fontStyle:"italic"},errorContainer:{backgroundColor:"#ffebee",borderColor:"#f44336",borderWidth:1,borderRadius:6,padding:10,marginBottom:15},errorText:{color:"#f44336",textAlign:"center"},disconnectButton:{backgroundColor:"#f44336",paddingVertical:10,paddingHorizontal:20,borderRadius:6},disconnectButtonText:{color:"white",textAlign:"center",fontWeight:"600"},newGameButton:{backgroundColor:"#4CAF50",paddingVertical:10,paddingHorizontal:20,borderRadius:6,marginBottom:10},newGameButtonText:{color:"white",textAlign:"center",fontWeight:"600"}}),F=e=>{let t,{gameMode:n,connectionStatus:r,invitationCode:s,error:a,connectionData:c,waitingForAnswer:d,timeRemaining:h,onCreateGame:u,onJoinGame:g,onDisconnect:m,onHandleAnswer:y,onCopyConnectionData:x,showMultiplayer:p,onToggleMultiplayer:C,gameStatus:f,onNewGame:b}=e,[A,j]=(0,i.useState)(""),[T,S]=(0,i.useState)("");return"local"!==n||p?"local"===n&&p?(0,o.jsxs)(l.A,{style:E.container,children:[(0,o.jsxs)(l.A,{style:E.header,children:[(0,o.jsx)(w.A,{style:E.title,children:"Play Online (BETA)"}),(0,o.jsx)(D.A,{style:E.closeButton,onPress:C,children:(0,o.jsx)(w.A,{style:E.closeButtonText,children:"✕"})})]}),(0,o.jsx)(w.A,{style:E.betaWarning,children:"⚠️ Beta feature - Cross-device manual connection"}),(0,o.jsxs)(l.A,{style:E.buttonContainer,children:[(0,o.jsx)(D.A,{style:E.button,onPress:u,children:(0,o.jsx)(w.A,{style:E.buttonText,children:"Host Game"})}),(0,o.jsx)(w.A,{style:E.orText,children:"or"}),(0,o.jsxs)(l.A,{style:E.joinContainer,children:[(0,o.jsx)(O.A,{style:E.textArea,placeholder:"Paste host's connection data here...",value:A,onChangeText:j,multiline:!0,numberOfLines:3}),(0,o.jsx)(D.A,{style:[E.button,E.joinButton],onPress:()=>{A.trim()&&g(A.trim())},disabled:!A.trim(),children:(0,o.jsx)(w.A,{style:E.buttonText,children:"Join Game"})})]})]})]}):(0,o.jsxs)(l.A,{style:E.container,children:[(0,o.jsxs)(l.A,{style:E.activeHeader,children:[(0,o.jsx)(w.A,{style:E.title,children:"host"===n?"Hosting Game":"Joining Game"}),(0,o.jsxs)(l.A,{style:E.statusContainer,children:[(0,o.jsx)(l.A,{style:[E.statusDot,{backgroundColor:(()=>{switch(r){case"connected":return"#4CAF50";case"connecting":return"#FF9800";case"error":return"#F44336";default:return"#9E9E9E"}})()}]}),(0,o.jsx)(w.A,{style:E.statusText,children:(()=>{switch(r){case"connected":return"Connected";case"connecting":return"Connecting...";case"error":return"Connection Error";default:return"Disconnected"}})()}),"connecting"===r&&h>0?(0,o.jsx)(w.A,{style:E.timerText,children:(t=Math.floor(h/60),"".concat(t,":").concat((h%60).toString().padStart(2,"0")))}):null]})]}),"host"===n&&c&&"connected"!==r?(0,o.jsxs)(l.A,{style:E.invitationContainer,children:[(0,o.jsx)(w.A,{style:E.invitationLabel,children:"Step 1: Share this connection data:"}),(0,o.jsxs)(l.A,{style:E.dataContainer,children:[(0,o.jsx)(O.A,{style:E.readOnlyTextArea,value:c,multiline:!0,numberOfLines:4,editable:!1}),(0,o.jsx)(D.A,{style:E.copyButton,onPress:x,children:(0,o.jsx)(w.A,{style:E.copyButtonText,children:"Copy"})})]}),(0,o.jsx)(w.A,{style:E.instructionText,children:"Send this data to your friend via message/email"}),d?(0,o.jsxs)(l.A,{style:E.answerSection,children:[(0,o.jsx)(w.A,{style:E.invitationLabel,children:"Step 2: Paste your friend's response:"}),(0,o.jsxs)(l.A,{style:E.dataContainer,children:[(0,o.jsx)(O.A,{style:E.textArea,placeholder:"Paste your friend's connection response here...",value:T,onChangeText:S,multiline:!0,numberOfLines:3}),(0,o.jsx)(D.A,{style:[E.copyButton,E.processButton],onPress:()=>{T.trim()&&y(T.trim())},disabled:!T.trim(),children:(0,o.jsx)(w.A,{style:E.copyButtonText,children:"Connect"})})]})]}):null]}):null,"guest"===n&&c&&"connected"!==r?(0,o.jsxs)(l.A,{style:E.invitationContainer,children:[(0,o.jsx)(w.A,{style:E.invitationLabel,children:"Send this response to the host:"}),(0,o.jsxs)(l.A,{style:E.dataContainer,children:[(0,o.jsx)(O.A,{style:E.readOnlyTextArea,value:c,multiline:!0,numberOfLines:4,editable:!1}),(0,o.jsx)(D.A,{style:E.copyButton,onPress:x,children:(0,o.jsx)(w.A,{style:E.copyButtonText,children:"Copy"})})]}),(0,o.jsx)(w.A,{style:E.instructionText,children:"Send this data back to the host to complete connection"})]}):null,a?(0,o.jsx)(l.A,{style:E.errorContainer,children:(0,o.jsx)(w.A,{style:E.errorText,children:a})}):null,"connected"===r&&"game_over"===f&&b?(0,o.jsx)(D.A,{style:E.newGameButton,onPress:b,children:(0,o.jsx)(w.A,{style:E.newGameButtonText,children:"New Game"})}):null,(0,o.jsx)(D.A,{style:E.disconnectButton,onPress:m,children:(0,o.jsx)(w.A,{style:E.disconnectButtonText,children:"Back to Local Game"})})]}):(0,o.jsx)(l.A,{style:E.betaContainer,children:(0,o.jsx)(D.A,{style:E.betaLink,onPress:C,children:(0,o.jsx)(w.A,{style:E.betaLinkText,children:"\uD83D\uDE80 Try Online Multiplayer (BETA)"})})})},H=a.A.create({container:{position:"fixed",bottom:8,right:8,zIndex:1e3},version:{fontSize:12,color:"#666",opacity:.7,fontFamily:"monospace"}}),G=()=>(0,o.jsx)(l.A,{style:H.container,children:(0,o.jsxs)(w.A,{style:H.version,children:["v","1.2.0"]})});var M=n(2528);let _=a.A.create({overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",justifyContent:"center",alignItems:"center",zIndex:1e3},modal:{backgroundColor:"white",borderRadius:12,maxWidth:600,width:"90%",maxHeight:"80vh",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.3)"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:20,borderBottomWidth:1,borderBottomColor:"#e0e0e0"},title:{fontSize:24,fontWeight:"bold",color:"#2c3e50"},closeButton:{width:30,height:30,borderRadius:15,backgroundColor:"#e74c3c",justifyContent:"center",alignItems:"center",display:"flex"},closeText:{color:"white",fontSize:20,fontWeight:"bold",textAlign:"center",lineHeight:30,margin:0,padding:0},content:{padding:20,maxHeight:"60vh"},section:{marginBottom:20},sectionTitle:{fontSize:18,fontWeight:"bold",color:"#34495e",marginBottom:10,borderBottomWidth:2,borderBottomColor:"#3498db",paddingBottom:5},subtitle:{fontSize:16,fontWeight:"bold",color:"#2c3e50",marginTop:10,marginBottom:5},text:{fontSize:14,lineHeight:20,color:"#333",marginBottom:5},bold:{fontWeight:"bold"},highlight:{backgroundColor:"#f8f9fa",padding:15,borderLeftWidth:4,borderLeftColor:"#3498db",marginTop:10,marginBottom:10},gameFlow:{backgroundColor:"#fff3cd",padding:15,borderLeftWidth:4,borderLeftColor:"#ffc107",marginTop:10},strategyTips:{backgroundColor:"#e8f5e8",padding:15,borderLeftWidth:4,borderLeftColor:"#27ae60",marginTop:10},footer:{padding:20,borderTopWidth:1,borderTopColor:"#e0e0e0",alignItems:"center"},closeModalButton:{backgroundColor:"#3498db",paddingHorizontal:30,paddingVertical:12,borderRadius:6},closeModalText:{color:"white",fontSize:16,fontWeight:"bold"}}),L=e=>{let{isVisible:t,onClose:n}=e;return t?(0,o.jsx)(l.A,{style:_.overlay,children:(0,o.jsxs)(l.A,{style:_.modal,children:[(0,o.jsxs)(l.A,{style:_.header,children:[(0,o.jsx)(w.A,{style:_.title,children:"\uD83C\uDFAE Triliza Game Rules"}),(0,o.jsx)(D.A,{onPress:n,style:_.closeButton,children:(0,o.jsx)(w.A,{style:_.closeText,children:"\xd7"})})]}),(0,o.jsxs)(M.A,{style:_.content,children:[(0,o.jsxs)(l.A,{style:_.section,children:[(0,o.jsx)(w.A,{style:_.sectionTitle,children:"Overview"}),(0,o.jsx)(w.A,{style:_.text,children:"Triliza is a modern take on the classic Tic-Tac-Toe game, featuring multi-dimensional gameplay and enhanced scoring mechanics."})]}),(0,o.jsxs)(l.A,{style:_.section,children:[(0,o.jsx)(w.A,{style:_.sectionTitle,children:"Objective"}),(0,o.jsx)(w.A,{style:_.text,children:"Score the most points by creating three-in-a-row patterns on the game board."})]}),(0,o.jsxs)(l.A,{style:_.section,children:[(0,o.jsx)(w.A,{style:_.sectionTitle,children:"Players"}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"Player X"})," (starts first)"]}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"Player O"})," (goes second)"]})]}),(0,o.jsxs)(l.A,{style:_.section,children:[(0,o.jsx)(w.A,{style:_.sectionTitle,children:"Game Board"}),(0,o.jsx)(w.A,{style:_.text,children:"• Default board size: 3x3 grid"}),(0,o.jsx)(w.A,{style:_.text,children:"• Each cell is numbered from 1-9 (top-left to bottom-right)"}),(0,o.jsx)(w.A,{style:_.text,children:"• Players take turns placing their symbol (X or O) in empty cells"})]}),(0,o.jsxs)(l.A,{style:_.section,children:[(0,o.jsx)(w.A,{style:_.sectionTitle,children:"Scoring System"}),(0,o.jsx)(w.A,{style:_.subtitle,children:"Three-in-a-Row Patterns:"}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"Horizontal"})," - Three symbols in the same row"]}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"Vertical"})," - Three symbols in the same column"]}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"Diagonal"})," - Three symbols diagonally (both directions)"]}),(0,o.jsxs)(l.A,{style:_.highlight,children:[(0,o.jsx)(w.A,{style:_.subtitle,children:"Scoring Mechanics:"}),(0,o.jsxs)(w.A,{style:_.text,children:["• Each three-in-a-row pattern = ",(0,o.jsx)(w.A,{style:_.bold,children:"1 point"})]}),(0,o.jsx)(w.A,{style:_.text,children:"• Multiple patterns can be created simultaneously"}),(0,o.jsx)(w.A,{style:_.text,children:"• Patterns are counted dynamically as the game progresses"}),(0,o.jsx)(w.A,{style:_.text,children:"• The player with the highest score when the board is full wins"})]})]}),(0,o.jsxs)(l.A,{style:_.section,children:[(0,o.jsx)(w.A,{style:_.sectionTitle,children:"Game Flow"}),(0,o.jsxs)(l.A,{style:_.gameFlow,children:[(0,o.jsxs)(w.A,{style:_.text,children:["1. ",(0,o.jsx)(w.A,{style:_.bold,children:"Setup"}),": Board starts empty with numbered cells (1-9)"]}),(0,o.jsxs)(w.A,{style:_.text,children:["2. ",(0,o.jsx)(w.A,{style:_.bold,children:"Turns"}),": Players alternate placing X or O in empty cells"]}),(0,o.jsxs)(w.A,{style:_.text,children:["3. ",(0,o.jsx)(w.A,{style:_.bold,children:"Scoring"}),": Points are calculated after each move"]}),(0,o.jsxs)(w.A,{style:_.text,children:["4. ",(0,o.jsx)(w.A,{style:_.bold,children:"Game End"}),": When all cells are filled (9 moves total)"]}),(0,o.jsxs)(w.A,{style:_.text,children:["5. ",(0,o.jsx)(w.A,{style:_.bold,children:"Winner"}),": Player with the highest score wins"]})]})]}),(0,o.jsxs)(l.A,{style:_.section,children:[(0,o.jsx)(w.A,{style:_.sectionTitle,children:"Winning Conditions"}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"Win"}),": Player with the highest score when board is full"]}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"Tie"}),": Both players have equal scores when board is full"]}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"No Draw"}),": Unlike traditional Tic-Tac-Toe, there's always a winner due to scoring"]})]}),(0,o.jsxs)(l.A,{style:_.section,children:[(0,o.jsx)(w.A,{style:_.sectionTitle,children:"Strategy Tips"}),(0,o.jsxs)(l.A,{style:_.strategyTips,children:[(0,o.jsxs)(w.A,{style:_.text,children:["1. ",(0,o.jsx)(w.A,{style:_.bold,children:"Block Opponent"}),": Prevent opponent from creating three-in-a-row patterns"]}),(0,o.jsxs)(w.A,{style:_.text,children:["2. ",(0,o.jsx)(w.A,{style:_.bold,children:"Create Multiple Patterns"}),": Try to set up moves that create multiple scoring opportunities"]}),(0,o.jsxs)(w.A,{style:_.text,children:["3. ",(0,o.jsx)(w.A,{style:_.bold,children:"Center Control"}),": The center cell (5) is often valuable for creating diagonal patterns"]}),(0,o.jsxs)(w.A,{style:_.text,children:["4. ",(0,o.jsx)(w.A,{style:_.bold,children:"Pattern Recognition"}),": Look for opportunities to complete existing two-in-a-row patterns"]})]})]}),(0,o.jsxs)(l.A,{style:_.section,children:[(0,o.jsx)(w.A,{style:_.sectionTitle,children:"Multiplayer Mode"}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"Local"}),": Two players on the same device"]}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"Online"}),": Play with friends over the internet (Beta feature)"]}),(0,o.jsxs)(w.A,{style:_.text,children:["• ",(0,o.jsx)(w.A,{style:_.bold,children:"Real-time"}),": Synchronized gameplay with live updates"]})]})]}),(0,o.jsx)(l.A,{style:_.footer,children:(0,o.jsx)(D.A,{onPress:n,style:_.closeModalButton,children:(0,o.jsx)(w.A,{style:_.closeModalText,children:"Got it!"})})})]})}):null},N=a.A.create({button:{position:"fixed",bottom:40,right:40,backgroundColor:"#3498db",paddingHorizontal:16,paddingVertical:8,borderRadius:20,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,zIndex:100},text:{color:"white",fontSize:14,fontWeight:"bold"}}),X=e=>{let{onPress:t}=e;return(0,o.jsx)(D.A,{onPress:t,style:N.button,children:(0,o.jsx)(w.A,{style:N.text,children:"\uD83D\uDCD6 Rules"})})},V=a.A.create({container:{alignItems:"center",margin:"auto",padding:10,minHeight:"100vh",justifyContent:"center"}}),U=()=>{let[e,t]=(0,i.useState)(!1),[n,a]=(0,i.useState)(!1),c=(0,i.useRef)(null),{gameMode:d,connectionStatus:h,invitationCode:u,error:g,connectionData:m,waitingForAnswer:x,timeRemaining:j,createGame:w,joinGame:T,sendGameState:S,disconnect:v,handleAnswer:R,copyConnectionData:B}=(e=>{let[t,n]=(0,i.useState)("local"),[o,r]=(0,i.useState)("disconnected"),[s,l]=(0,i.useState)(""),[a,c]=(0,i.useState)(!1),[d,h]=(0,i.useState)(""),[u,g]=(0,i.useState)(""),[m,y]=(0,i.useState)(!1),[x,f]=(0,i.useState)(0),b=(0,i.useRef)(null),A=(0,i.useRef)(null),j=(0,i.useCallback)(e=>{console.log("Connection status changed:",e),r(e),"error"===e?h("Connection failed. Please try again."):"connected"===e&&h("")},[]),w=(0,i.useCallback)(t=>{console.log("WebRTC data received:",t),"gameState"===t.type&&(console.log("Updating game state from remote player:",t.payload),null==e||e(t.payload))},[e]),T=(0,i.useCallback)(e=>{f(e)},[]),S=(0,i.useCallback)(async()=>{try{let e;h(""),n("host"),c(!0),r("connecting"),b.current=new p,b.current.onConnectionChange=j,b.current.onDataReceived=w,b.current.onTimerUpdate=T;let t=b.current.generateInvitationCode();l(t),await b.current.createConnection(!0,t),e=setInterval(()=>{if(b.current.iceGatheringComplete||b.current.iceCandidates.length>0){clearInterval(e);let t=b.current.getConnectionString();g(t),y(!0),console.log("Host connection data ready")}},100),setTimeout(()=>{if(clearInterval(e),!u){let e=b.current.getConnectionString();g(e),y(!0),console.log("Host connection data ready (fallback)")}},5e3)}catch(e){console.error("Failed to create game:",e),h("Failed to create game: "+e.message),r("error")}},[j,w,T,u]),v=(0,i.useCallback)(async e=>{try{let t;h(""),n("guest"),c(!1),r("connecting"),b.current=new p,b.current.onConnectionChange=j,b.current.onDataReceived=w,b.current.onTimerUpdate=T,await b.current.createConnection(!1),await b.current.handleConnectionString(e),t=setInterval(()=>{if(b.current.iceGatheringComplete||b.current.iceCandidates.length>0){clearInterval(t);let e=b.current.getConnectionString();g(e),console.log("Guest answer ready")}},100),setTimeout(()=>{if(clearInterval(t),!u){let e=b.current.getConnectionString();g(e),console.log("Guest answer ready (fallback)")}},5e3)}catch(e){console.error("Failed to join game:",e),h("Failed to join game: "+e.message),r("error")}},[j,w,T,u]),R=(0,i.useCallback)(e=>{console.log("Attempting to send game state:",e,"Connection status:",o),b.current&&"connected"===o?(console.log("Sending game state via WebRTC:",e),b.current.sendData({type:"gameState",payload:e})):console.log("Cannot send game state - not connected")},[o]),B=(0,i.useCallback)(()=>{console.log("Disconnecting..."),A.current&&(clearInterval(A.current),A.current=null),b.current&&(b.current.disconnect(),b.current=null),n("local"),r("disconnected"),l(""),c(!1),h(""),f(0)},[]),k=(0,i.useCallback)(async e=>{try{b.current&&a&&(await b.current.handleConnectionString(e),y(!1),console.log("Host processed guest answer"))}catch(e){console.error("Failed to handle answer:",e),h("Failed to process connection data: "+e.message)}},[a]),P=(0,i.useCallback)(async()=>{u&&await C(u)},[u]);return(0,i.useEffect)(()=>{let e=(()=>{try{return new URLSearchParams(window.location.search).get("code")}catch(e){return console.error("Failed to get invitation code from URL:",e),null}})();e&&(console.log("Found invitation code in URL:",e),v(e))},[v]),(0,i.useEffect)(()=>()=>{A.current&&clearInterval(A.current),b.current&&b.current.disconnect()},[]),{gameMode:t,connectionStatus:o,invitationCode:s,isHost:a,error:d,connectionData:u,waitingForAnswer:m,timeRemaining:x,createGame:S,joinGame:v,sendGameState:R,disconnect:B,handleAnswer:k,copyConnectionData:P}})((0,i.useCallback)(e=>{c.current&&c.current.syncGameState(e)},[])),{gameState:P,actions:W}=y("local"!==d?S:null);c.current=W;let{cellSize:D,fontSize:O,containerWidth:E}=(e=>{let[t,n]=(0,i.useState)(()=>{let t=f(e);return{cellSize:t,fontSize:b(t),containerWidth:A(e,t)}});return(0,i.useEffect)(()=>{let t=()=>{let t=f(e);n({cellSize:t,fontSize:b(t),containerWidth:A(e,t)})};t();let o=()=>{t()};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[e]),t})(P.dimension),H=()=>{a(!n)},M=(0,s._)((0,r._)({},V.container),{maxWidth:E,width:"100%"});return(0,o.jsxs)(l.A,{style:M,children:[(0,o.jsx)(F,{gameMode:d,connectionStatus:h,invitationCode:u,error:g,connectionData:m,waitingForAnswer:x,timeRemaining:j,onCreateGame:w,onJoinGame:T,onDisconnect:()=>{v(),t(!1)},onHandleAnswer:R,onCopyConnectionData:B,showMultiplayer:e,onToggleMultiplayer:()=>{"local"!==d&&v(),t(!e)},gameStatus:P.gameStatus,onNewGame:"local"!==d?W.resetGame:null}),"local"===d||"local"!==d&&"connected"!==h||"local"!==d&&"connected"===h&&0===P.moveCounter?(0,o.jsx)(I,{dimension:P.dimension,onDecrease:()=>{P.dimension>3&&W.changeDimension(P.dimension-1)},onIncrease:()=>{W.changeDimension(P.dimension+1)},onNewGame:W.resetGame}):null,(0,o.jsx)(X,{onPress:H}),(0,o.jsx)(k,{board:P.board,onCellPress:(e,t)=>{("local"===d||"connected"===h&&("host"===d&&"X"===P.currentPlayer||"guest"===d&&"O"===P.currentPlayer))&&W.makeMove(e,t)},gameStatus:P.gameStatus,currentPlayer:P.currentPlayer,cellSize:D,fontSize:O,disabled:"local"!==d&&"connected"!==h,gameMode:d}),(0,o.jsx)(z,{currentPlayer:P.currentPlayer,moveCounter:P.moveCounter,gameHistory:P.gameHistory,scoreX:P.scoreX,scoreO:P.scoreO,gameStatus:P.gameStatus,gameMode:d,connectionStatus:h}),(0,o.jsx)(G,{}),n?(0,o.jsx)(L,{isVisible:n,onClose:H}):null]})};function J(){let[e,t]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{t(!0)},[]),e)?(0,o.jsx)("main",{children:(0,o.jsx)(U,{})}):null}}},e=>{e.O(0,[718,757,441,794,358],()=>e(e.s=7273)),_N_E=e.O()}]);